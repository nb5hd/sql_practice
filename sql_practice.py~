import psycopg2

conn = psycopg2.connect(database="nikhil", user="postgres", password = "", host = "localhost", port = "5432")

print "Opened database successfully"

cur = conn.cursor()

cur.execute("""CREATE TABLE cars(
id serial NOT NULL,
mpg FLOAT8,
cylinders INTEGER,
displacement INTEGER,
horsepower INTEGER,
weight INTEGER,
acceleration FLOAT8,
model_year INTEGER,
name TEXT
)""")

cur.execute("""
COPY cars(mpg,cylinders,displacement,horsepower,weight,acceleration,model_year, name)  FROM '/Users/nikhil/Documents/Riparian/sql_practice/auto_data.csv' DELIMITER ',' CSV HEADER;
""")

cur.execute("SELECT id, name, weight FROM cars")
rows = cur.fetchall()
for row in rows:
    if(row[0] % 5 == 0):
        print "ID = ", row[0]
        print "NAME = ", row[1]
        print "WEIGHT = ", row[2]
        print "\n"

conn.commit()
conn.close()
